{"version":3,"file":"WebStats-dist.js","sources":["src/Connection.ts","src/Data.ts","node_modules/@itsjavi/jsx-runtime/dist/jsx-runtime.modern.js","src/FormattingCodes.tsx","src/Table.tsx","src/Display.tsx","src/Pagination.tsx","src/WebStats.ts"],"sourcesContent":["export default class Connection {\r\n\tall: string\r\n\tscores: string\r\n\tonline: string\r\n\ttables: string\r\n\r\n\tconstructor({ all, scores, online, tables }) {\r\n\t\tthis.all = all\r\n\t\tthis.scores = scores\r\n\t\tthis.online = online\r\n\t\tthis.tables = tables\r\n\t}\r\n\r\n\tstatic json(host: string) {\r\n\t\t// Detect if the user has manually entered a protocol (could be https)\r\n\t\tconst protocol = host.startsWith(\"http\") ? \"\" : \"http://\"\r\n\t\treturn new Connection({\r\n\t\t\tall:    `${protocol}${host}/stats.json`,\r\n\t\t\tscores: `${protocol}${host}/scoreboard.json`,\r\n\t\t\tonline: `${protocol}${host}/online.json`,\r\n\t\t\ttables: `${protocol}${host}/tables.json`,\r\n\t\t})\r\n\t}\r\n\r\n\tgetStats = async () => {\r\n\t\tif (this.all) {\r\n\t\t\treturn await (await fetch(this.all)).json()\r\n\t\t} else {\r\n\t\t\tconst [online, scoreboard] = await Promise.all([this.getOnline(), this.getScoreboard()])\r\n\t\t\treturn { online, scoreboard }\r\n\t\t}\r\n\t}\r\n\tgetScoreboard = () => fetch(this.scores).then(response => response.json()).catch(() => {})\r\n\tgetOnline = () => fetch(this.online).then(response => response.json()).catch(() => {})\r\n\tgetTables = () => fetch(this.tables).then(response => response.json()).catch(() => {})\r\n}\r\n","export type PlayerStatus = \"online\" | \"afk\" | \"offline\"\r\ntype Scoreboard = {\r\n\tentries: string[],\r\n\tscores: { [column: string]: { [entry: string]: string } },\r\n\tcolumns?: string[]\r\n}\r\ntype Online = { [player: string]: boolean | \"afk\" }\r\ntype Entry = [number, string, ...(string)[]]\r\n\r\nexport default class Data {\r\n\tscoreboard: Scoreboard\r\n\tcolumns: string[]\r\n\tscores: Entry[]\r\n\tplayers: Online\r\n\tcolumns_: { [column: string]: number }\r\n\tplayernames: string[]\r\n\r\n\tconstructor(data: { scoreboard: Scoreboard, online: Online, playernames: string[] }) {\r\n\t\tthis.setStats(data)\r\n\t}\r\n\r\n\tget entries() { return this.scoreboard.entries }\r\n\tget online() { return this.players }\r\n\tget nOnline() { return Object.keys(this.players).length }\r\n\r\n\tisOnline = (player: string) => this.players[player] === true\r\n\tisAFK = (player: string) => this.players[player] === \"afk\"\r\n\tisOffline = (player: string) => !!this.players[player]\r\n\tgetStatus = (player: string): PlayerStatus => this.isOnline(player) ? \"online\"\r\n\t\t: (this.isAFK(player) ? \"afk\" : \"offline\")\r\n\tisCurrentPlayer = (player: string) => this.playernames?.includes(player) ?? false\r\n\r\n\tsetScoreboard(scoreboard: Scoreboard) {\r\n\t\tthis.scoreboard = scoreboard\r\n\t\tthis.columns = Object.keys(scoreboard.scores).sort()\r\n\r\n\t\tthis.filter()\r\n\r\n\t\tthis.scores = []\r\n\t\tfor (const entryName of this.entries) {\r\n\t\t\tconst entry = []\r\n\t\t\tentry.push(this.scores.push(entry as Entry) - 1)\r\n\t\t\tentry.push(entryName)\r\n\t\t\tfor (const columnName of this.columns) {\r\n\t\t\t\tentry.push(this.scoreboard.scores[columnName]?.[entryName] ?? 0)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Reverse-map column names to indices\r\n\t\t// (index 0 contains the original index, before sorting)\r\n\t\tthis.columns_ = { Player: 1 }\r\n\t\tthis.columns.forEach((val, idx) => this.columns_[val] = idx + 2)\r\n\t}\r\n\tsetOnlineStatus(online: Online) { this.players = online }\r\n\tsetPlayernames(playernames: string[]) { this.playernames = playernames }\r\n\tsetStats(data: { scoreboard: Scoreboard, online: Online, playernames: string[] }) {\r\n\t\tthis.setScoreboard(data.scoreboard)\r\n\t\tthis.setOnlineStatus(data.online)\r\n\t\tthis.setPlayernames(data.playernames)\r\n\t}\r\n\r\n\tfilter() {\r\n\t\t// Remove non-player / empty entries and sort\r\n\t\tthis.scoreboard.entries = this.scoreboard.entries\r\n\t\t\t.filter(Data.isPlayerOrServer)\r\n\t\t\t.filter(this.isNonemptyEntry.bind(this))\r\n\t\t\t.sort(Intl.Collator().compare)\r\n\r\n\t\t// Remove empty columns\r\n\t\tthis.scoreboard.scores = Data.filter(this.scoreboard.scores, Data.isNonemptyObjective)\r\n\t}\r\n\r\n\tsort(by: string, descending: boolean) {\r\n\t\t// Pre-create collator for significant performance improvement\r\n\t\t// over `a.localeCompare(b, undefined, {sensitivity: \"base\"})`\r\n\t\t// funny / weird thing: for localeCompare, supplying an empty `options`\r\n\t\t// object is way slower than supplying nothing...\r\n\t\tconst collator = new Intl.Collator(undefined, { sensitivity: \"base\" })\r\n\r\n\t\t// When a and b are both numbers, compare as numbers.\r\n\t\t// Otherwise, case-insensitive compare as string\r\n\t\tthis.scores = this.scores.sort((a_row, b_row) => {\r\n\t\t\tconst a = a_row[this.columns_[by]]\r\n\t\t\tconst b = b_row[this.columns_[by]]\r\n\t\t\tif (!isNaN(Number(a)) && !isNaN(Number(b))) {\r\n\t\t\t\treturn (descending ? -1 : 1) * ((a as number) - (b as number))\r\n\t\t\t} else {\r\n\t\t\t\treturn (descending ? -1 : 1) * collator.compare(a as string, b as string)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// Ignore all entries which have no scores (armour stand book fix)\r\n\t// (also hides entries with only 0 values)\r\n\tisNonemptyEntry = (entry: string) => Object.entries(this.scoreboard.scores)\r\n\t\t.filter(([_, score]) => score[entry] && score[entry] != \"0\").length > 0\r\n\r\n\t// Valid player names only contain between 3 and 16 characters [A-Za-z0-9_],\r\n\t// entries with only digits are ignored as well (common for datapacks)\r\n\tstatic isPlayerOrServer = (entry: string) =>\r\n\t\tentry == \"#server\" || (entry.match(/^\\w{3,16}$/) && !entry.match(/^\\d*$/))\r\n\r\n\t// Whether any entry has a value for this objective\r\n\tstatic isNonemptyObjective = (objective: { [entry: string]: string | number }) =>\r\n\t\tObject.keys(objective).filter(Data.isPlayerOrServer).length > 0\r\n\r\n\t// Array-like filter function for objects\r\n\t// https://stackoverflow.com/a/37616104\r\n\tstatic filter = <V>(obj: { [k: string]: V }, predicate: (_: V) => boolean): { [k: string]: V } =>\r\n\t\tObject.fromEntries(Object.entries(obj).filter(([_, v]) => predicate(v)))\r\n\r\n\t// Likewise, array-like map function for objects\r\n\tstatic map = <V>(obj: { [k: string]: V }, mapper: (k: string, v: V) => V) =>\r\n\t\tObject.fromEntries(Object.entries(obj).map(([k, v]) => [k, mapper(k, v)]))\r\n\r\n}\r\n","function e(){return e=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},e.apply(this,arguments)}const n=[\"children\"],t=\"jsx.Fragment\",r=\"jsx.Text\";function o(t,o){if(\"function\"==typeof t)return void 0!==t.prototype?new t(o):t(o);const{children:l=[]}=o;return{type:t,key:null,props:e({},function(e,n){if(null==e)return{};var t,r,o={},l=Object.keys(e);for(r=0;r<l.length;r++)n.indexOf(t=l[r])>=0||(o[t]=e[t]);return o}(o,n),{children:Array().concat(l).map(e=>\"object\"==typeof e?e:{type:r,key:null,props:{text:e,children:[]}})})}}o.Fragment=t,o.TextNode=r,o.customAttributes=[\"children\",\"key\",\"props\"];const l=e=>!o.customAttributes.includes(e);class s{constructor(e){this.element=null,this.props=void 0,this.props=e}render(){return null}}\"undefined\"!=typeof window&&(o._globalThis=window),o.setGlobalThis=e=>{o._globalThis=e},o.renderDOM=(e,n=null,t=null,r=!1)=>{const i=e instanceof s;let c=i?e.render():e;i&&(t=e);const a=null===n?o._globalThis.document:n.ownerDocument;if(c.type===o.TextNode){void 0===c.props.text&&(c.props.text=\"\");const e=a.createTextNode(c.props.text);return null!==n&&n.appendChild(e),e}const u=c.type===o.Fragment?a.createDocumentFragment():a.createElement(c.type);u.jsxComponent=t;const p=c.props,d=Object.keys(p);void 0!==p.className&&Array.isArray(p.className)&&(p.className=p.className.join(\" \")),d.filter(l).forEach(e=>{let n=p[e];null!==t&&n instanceof Function&&(n=n.bind(t),n instanceof Function&&n(null)),e.startsWith(\"data-\")&&u.setAttribute(e,n),u[e]=n,u[e.toLowerCase()]=n}),Array.isArray(c.props.children)&&c.props.children.forEach(e=>o.renderDOM(e,u,t));let h=null;return i&&null!==t&&(h=t.element,t.element=u),i&&null!==t&&void 0!==t.onWillMount&&t.onWillMount(h),null!==n&&(r?n.replaceChildren(u):n.appendChild(u)),i&&null!==t&&void 0!==t.onDidMount&&t.onDidMount(h),u};const i=(e,n=null,t=null)=>o.renderDOM(e,n,t,!0);export{s as Component,t as Fragment,o as jsx,o as jsxs,i as render};\n//# sourceMappingURL=jsx-runtime.modern.js.map\n","type ColourCode =\r\n\t| \"§0\"\r\n\t| \"§1\"\r\n\t| \"§2\"\r\n\t| \"§3\"\r\n\t| \"§4\"\r\n\t| \"§5\"\r\n\t| \"§6\"\r\n\t| \"§7\"\r\n\t| \"§8\"\r\n\t| \"§9\"\r\n\t| \"§a\"\r\n\t| \"§b\"\r\n\t| \"§c\"\r\n\t| \"§d\"\r\n\t| \"§e\"\r\n\t| \"§f\"\r\n\r\ntype FormattingCode =\r\n\t| \"§k\"\r\n\t| \"§l\"\r\n\t| \"§m\"\r\n\t| \"§n\"\r\n\t| \"§o\"\r\n\t| \"§r\"\r\n\r\ntype FormattingCodePart = {\r\n\ttext: string\r\n\tformat?: FormattingCode\r\n\tcolour?: ColourCode | string\r\n\tcolourType?: \"simple\" | \"hex\"\r\n}\r\n\r\nconst COLOUR_CODES: {[code in ColourCode]: string} = {\r\n\t[\"§0\"]: \"black\",\r\n\t[\"§1\"]: \"dark_blue\",\r\n\t[\"§2\"]: \"dark_green\",\r\n\t[\"§3\"]: \"dark_aqua\",\r\n\t[\"§4\"]: \"dark_red\",\r\n\t[\"§5\"]: \"dark_purple\",\r\n\t[\"§6\"]: \"gold\",\r\n\t[\"§7\"]: \"gray\",\r\n\t[\"§8\"]: \"dark_gray\",\r\n\t[\"§9\"]: \"blue\",\r\n\t[\"§a\"]: \"green\",\r\n\t[\"§b\"]: \"aqua\",\r\n\t[\"§c\"]: \"red\",\r\n\t[\"§d\"]: \"light_purple\",\r\n\t[\"§e\"]: \"yellow\",\r\n\t[\"§f\"]: \"white\",\r\n}\r\n\r\nconst FORMATTING_CODES: {[code in FormattingCode]: string} = {\r\n\t[\"§k\"]: \"obfuscated\",\r\n\t[\"§l\"]: \"bold\",\r\n\t[\"§m\"]: \"strikethrough\",\r\n\t[\"§n\"]: \"underline\",\r\n\t[\"§o\"]: \"italic\",\r\n\t[\"§r\"]: \"reset\",\r\n}\r\n\r\n// § followed by a single character, or of the form §x§r§r§g§g§b§b\r\n// (also capture rest of string, until next §)\r\nconst FORMATTING_CODE_REGEX = /(§x§.§.§.§.§.§.|§.)([^§]*)/gm\r\n\r\n// Convert a single formatting code to a <span> element\r\nfunction convertFormattingCode(part: FormattingCodePart) {\r\n\tif (!part.format && !part.colour) return part.text\r\n\tif (part.text.length == 0) return part.text\r\n\t\r\n\tconst classes = [\"mc-format\"]\r\n\tif (part.format) classes.push(`mc-${part.format}`)\r\n\tif (part.colourType == \"simple\") classes.push(`mc-${part.colour}`)\r\n\t\r\n\treturn (\r\n\t\t<span className={classes} style={part.colourType == \"hex\" && `color: ${part.colour}`}>\r\n\t\t\t{part.text}\r\n\t\t</span>\r\n\t)\r\n}\r\n\r\nfunction parseFormattingCodes(value: string): FormattingCodePart[] {\r\n\tconst parts = []\r\n\r\n\tconst firstIdx = value.matchAll(FORMATTING_CODE_REGEX).next().value?.index\r\n\tif (firstIdx == undefined || firstIdx > 0) {\r\n\t\tparts.push({ text: value.substring(0, firstIdx) })\r\n\t}\r\n\r\n\tfor (const match of value.matchAll(FORMATTING_CODE_REGEX)) {\r\n\t\tparts.push(parseFormattingCode(match[1], match[2], parts[parts.length - 1]))\r\n\t}\r\n\r\n\treturn parts\r\n}\r\n\r\nfunction parseFormattingCode(code: string, text: string, prev: FormattingCodePart): FormattingCodePart {\r\n\t// Simple colour codes and formatting codes\r\n\tif (COLOUR_CODES[code]) {\r\n\t\treturn {\r\n\t\t\ttext,\r\n\t\t\tcolour: COLOUR_CODES[code],\r\n\t\t\tcolourType: \"simple\",\r\n\t\t}\r\n\t}\r\n\tif (FORMATTING_CODES[code]) {\r\n\t\treturn {\r\n\t\t\ttext,\r\n\t\t\tformat: FORMATTING_CODES[code],\r\n\t\t\tcolour: prev?.colour,\r\n\t\t\tcolourType: prev?.colourType,\r\n\t\t}\r\n\t}\r\n\r\n\t// Hex colour codes\r\n\tconst matches = code.match(/§x§(.)§(.)§(.)§(.)§(.)§(.)/m)\r\n\tif (matches) {\r\n\t\treturn {\r\n\t\t\ttext,\r\n\t\t\tcolour: \"#\" + matches.slice(1).join(\"\"),\r\n\t\t\tcolourType: \"hex\",\r\n\t\t}\r\n\t}\r\n\r\n\t// Not a valid formatting code, just return the input unaltered\r\n\treturn { text }\r\n}\r\n\r\n// Replace all formatting codes by <span> elements\r\nexport const convertFormattingCodes = (value: string) =>\r\n\tparseFormattingCodes(value).map(convertFormattingCode)\r\n","import { Component } from \"@itsjavi/jsx-runtime\"\r\nimport { PlayerStatus } from \"./Data\"\r\nimport { convertFormattingCodes } from \"./FormattingCodes\"\r\n\r\nconst CONSOLE_IMAGE = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAPElEQVQ4T2NUUlL6z0ABYBw1gGE0DBioHAZ3795lUFZWJildosQCRQaQoxnkVLgL0A2A8dFpdP8NfEICAMkiK2HeQ9JUAAAAAElFTkSuQmCC\"\r\n\r\ntype HeadingData = {\r\n\tcolumns: string[]\r\n\tshowSkins: boolean\r\n\tsortColumn: string\r\n\tsortDescending: boolean\r\n\tonClick: (e: Event) => any\r\n}\r\n\r\nconst columnClass = (column: string, sortColumn: string, sortDescending: boolean) =>\r\n\tsortColumn == column && [\"webstats-sort-column\", sortDescending ? \"descending\" : \"ascending\"]\r\n\r\nconst onKeyDown = (e: KeyboardEvent) => {\r\n\tif (e.key == \"Enter\") (e.target as HTMLElement).click()\r\n}\r\n\r\nexport const Heading = ({ columns, showSkins, sortColumn, sortDescending, onClick }: HeadingData) => (\r\n\t<tr>\r\n\t\t<th colSpan={showSkins && 2} onClick={onClick} onKeyDown={onKeyDown} tabIndex=\"0\" data-objective=\"Player\" className={columnClass(\"Player\", sortColumn, sortDescending)}>\r\n\t\t\tPlayer\r\n\t\t</th>\r\n\t\t{...columns.map(column => <th onClick={onClick} onKeyDown={onKeyDown} tabIndex=\"0\" data-objective={column} className={columnClass(column, sortColumn, sortDescending)}>\r\n\t\t\t{column}\r\n\t\t</th>)}\r\n\t</tr>)\r\n\r\nconst Avatar = ({ entry }: { entry: string }) => (\r\n\t<td className={[\"sticky\", \"skin\"]}>\r\n\t\t<img\r\n\t\t\ttitle={entry}\r\n\t\t\tsrc={entry == \"#server\" ? CONSOLE_IMAGE : `https://www.mc-heads.net/avatar/${entry}.png`} />\r\n\t</td>\r\n)\r\n\r\nconst Cell = ({ column, value }: { column: string, value: string }) => {\r\n\tif (value == undefined || value == \"0\") return <td data-objective={column} className=\"empty\"></td>\r\n\tconst formatted = isNaN(value as any) ? value : Number(value).toLocaleString()\r\n\tconst coloured = convertFormattingCodes(formatted)\r\n\treturn <td data-objective={column} data-value={value}>{coloured}</td>\r\n}\r\n\r\nconst PlayerCell = ({ entry, status }: { entry: string, status: PlayerStatus }) => (\r\n\t<td data-objective=\"Player\" data-value={entry}>\r\n\t\t<div className={[\"status\", status]} title={status}></div>\r\n\t\t{entry == \"#server\" ? \"Server\" : entry}\r\n\t</td>\r\n)\r\n\r\ntype RowData = {\r\n\tcolumns: string[]\r\n\tshowSkins: boolean\r\n\tentry: string\r\n\tisCurrentPlayer: boolean\r\n}\r\n\r\nexport class Row extends Component {\r\n\tvalues: Map<string, string> = new Map()\r\n\tstatus: PlayerStatus = \"offline\"\r\n\r\n\tconstructor(public props: RowData) {\r\n\t\tsuper(props)\r\n\t}\r\n\r\n\trender = () => (\r\n\t\t<tr entry={this.props.entry} className={[this.status, this.props.isCurrentPlayer ? \"current-player\" : undefined]}>\r\n\t\t\t{this.props.showSkins && <Avatar entry={this.props.entry} />}\r\n\t\t\t<PlayerCell entry={this.props.entry} status={this.status} />\r\n\t\t\t{...this.props.columns.map(column => <Cell column={column} value={this.values.get(column)} />)}\r\n\t\t</tr>\r\n\t)\r\n}\r\n","import { ijJSX, render } from \"@itsjavi/jsx-runtime\"\r\nimport Data from \"./Data\"\r\nimport Pagination from \"./Pagination\"\r\nimport { Heading, Row } from \"./Table\"\r\nimport { TableConfig } from \"./WebStats\"\r\n\r\nexport default class Display {\r\n\ttable: HTMLTableElement\r\n\tpagination?: Pagination\r\n\tcolumns: string[]\r\n\tsortColumn: string\r\n\tdescending: boolean\r\n\tshowSkins: boolean\r\n\thideOffline: boolean\r\n\r\n\tdata: Data\r\n\trows: Map<string, Row>\r\n\r\n\tconstructor({ table, pagination, showSkins = true }, { columns, sortColumn = \"Player\", sortDirection = \"descending\" }: TableConfig) {\r\n\t\tthis.table = table\r\n\t\tthis.pagination = pagination\r\n\t\tthis.columns = columns\r\n\t\tthis.sortColumn = sortColumn\r\n\t\tthis.descending = sortDirection == \"descending\"\r\n\t\tthis.showSkins = showSkins\r\n\t\tthis.hideOffline = false\r\n\r\n\t\tif (this.pagination) this.pagination.onPageChange = (page) => this.show()\r\n\t}\r\n\r\n\tinit(data: Data) {\r\n\t\tthis.data = data\r\n\r\n\t\t// Set pagination controls\r\n\t\tif (this.pagination) this.updatePagination()\r\n\r\n\t\t// Create rows of (empty) entries\r\n\t\tthis.rows = new Map()\r\n\t\tfor (const entry of this.getEntries()) {\r\n\t\t\tthis.rows.set(entry, new Row({\r\n\t\t\t\tcolumns: this.columns ?? this.data.columns,\r\n\t\t\t\tshowSkins: this.showSkins,\r\n\t\t\t\tentry,\r\n\t\t\t\tisCurrentPlayer: this.data.isCurrentPlayer(entry)\r\n\t\t\t}))\r\n\t\t}\r\n\r\n\t\t// Fill entries\r\n\t\tthis.updateStats()\r\n\t}\r\n\r\n\tgetEntries() {\r\n\t\tconst entriesHere = this.data.entries.filter((entry: string) =>\r\n\t\t\t(this.columns ?? this.data.columns).some((column: string) =>\r\n\t\t\t\tthis.data.scoreboard.scores[column]?.[entry]\r\n\t\t\t\t&& this.data.scoreboard.scores[column][entry] != \"0\"))\r\n\r\n\t\treturn this.hideOffline\r\n\t\t\t? entriesHere.filter(entry => this.data.isOnline(entry))\r\n\t\t\t: entriesHere\r\n\t}\r\n\r\n\tgetScores() {\r\n\t\tconst scoresHere = this.data.scores.filter(row => this.rows.has(row[1]))\r\n\r\n\t\treturn this.hideOffline\r\n\t\t\t? scoresHere.filter(row => this.data.isOnline(row[1]))\r\n\t\t\t: scoresHere\r\n\t}\r\n\r\n\tupdatePagination() {\r\n\t\tthis.pagination.update(this.getEntries().length)\r\n\t}\r\n\r\n\tupdateScoreboard() {\r\n\t\tfor (const row of this.data.scores) {\r\n\t\t\tif (!this.rows.has(row[1])) continue\r\n\t\t\tfor (const column of this.columns ?? this.data.columns) {\r\n\t\t\t\tlet value = row[this.data.columns_[column]] as string\r\n\t\t\t\tif (!value) continue\r\n\t\t\t\tthis.rows.get(row[1]).values.set(column, value)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tupdateScoreboardAndShow() {\r\n\t\tthis.updateScoreboard()\r\n\t\tthis.show()\r\n\t}\r\n\r\n\tupdateOnlineStatus() {\r\n\t\tfor (const [_, row] of this.rows) {\r\n\t\t\trow.status = this.data.getStatus(row.props.entry)\r\n\t\t}\r\n\t}\r\n\r\n\tupdateOnlineStatusAndShow() {\r\n\t\tthis.updateOnlineStatus()\r\n\t\tif (this.pagination) this.show()\r\n\t}\r\n\r\n\tupdateStats() {\r\n\t\tthis.updateScoreboard()\r\n\t\tthis.updateOnlineStatus()\r\n\t}\r\n\r\n\tupdateStatsAndShow() {\r\n\t\tthis.updateStats()\r\n\t\tthis.show()\r\n\t}\r\n\r\n\tchangeHideOffline(hideOffline: boolean) {\r\n\t\tthis.hideOffline = hideOffline\r\n\t\tif (this.pagination) {\r\n\t\t\tthis.updatePagination()\r\n\t\t\tthis.pagination.changePage(1)\r\n\t\t\tthis.show()\r\n\t\t}\r\n\t}\r\n\r\n\t// Re-display table contents\r\n\tshow() {\r\n\t\tthis.data.sort(this.sortColumn, this.descending)\r\n\t\tconst scores = this.getScores()\r\n\t\tconst [min, max] = this.pagination\r\n\t\t\t? this.pagination.getRange(scores.length)\r\n\t\t\t: [0, scores.length]\r\n\r\n\t\tconst rows: ijJSX.Node[] = []\r\n\t\trows.push(<Heading\r\n\t\t\tcolumns={this.columns ?? this.data.columns}\r\n\t\t\tshowSkins={this.showSkins}\r\n\t\t\tsortColumn={this.sortColumn}\r\n\t\t\tsortDescending={this.descending}\r\n\t\t\tonClick={this.thClick.bind(this)} />)\r\n\t\tfor (let i = min; i < max; i++) {\r\n\t\t\trows.push(this.rows.get(scores[i][1]))\r\n\t\t}\r\n\t\trender(<>{rows}</>, this.table)\r\n\t}\r\n\r\n\t// When a table header is clicked, sort by that header\r\n\t// (also called when the table header is activated through keyboard navigation)\r\n\tthClick(e: Event) {\r\n\t\tconst objective = (e.target as HTMLTableCellElement).getAttribute(\"data-objective\")\r\n\t\tthis.descending = (objective === this.sortColumn) ? !this.descending : true\r\n\t\tthis.sortColumn = objective\r\n\t\tthis.pagination?.changePage(1)\r\n\t\tthis.show()\r\n\t\t\r\n\t\t// Restore focused element (for keyboard navigation)\r\n\t\tfor (const th of this.table.getElementsByTagName(\"th\")) {\r\n\t\t\tif (th.innerText == objective) {\r\n\t\t\t\tth.focus()\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Replace single quotes by '&quot;' (html-escape)\r\n\tstatic quoteEscape = (string: string) => string.replace(/'/g, \"&quot;\")\r\n\r\n}\r\n","import { render } from \"@itsjavi/jsx-runtime\"\r\n\r\nexport default class Pagination {\r\n\tmaxPage: number\r\n\tdisplayCount: number\r\n\tcurrentPage: number\r\n\r\n\tparentElem: HTMLElement\r\n\tselectElem: HTMLSelectElement\r\n\tprevButton: HTMLButtonElement\r\n\tnextButton: HTMLButtonElement\r\n\r\n\tonPageChange: (page: number) => void\r\n\r\n\tconstructor(displayCount: number, elem: HTMLElement) {\r\n\t\tthis.displayCount = displayCount\r\n\t\tthis.currentPage = 1\r\n\r\n\t\tthis.parentElem = elem\r\n\t\tthis.selectElem = elem.querySelector(\"select.webstats-pagination[name=page]\")\r\n\t\tthis.prevButton = elem.querySelector(\"button.webstats-pagination[name=prev]\")\r\n\t\tthis.nextButton = elem.querySelector(\"button.webstats-pagination[name=next]\")\r\n\r\n\t\tthis.selectElem.addEventListener(\"change\",\r\n\t\t\t(e) => this.changePageAndCallback(Number((e.target as HTMLSelectElement).value)))\r\n\t\tthis.prevButton.addEventListener(\"click\",\r\n\t\t\t() => this.changePageAndCallback(this.currentPage - 1))\r\n\t\tthis.nextButton.addEventListener(\"click\",\r\n\t\t\t() => this.changePageAndCallback(this.currentPage + 1))\r\n\t}\r\n\r\n\tstatic create(displayCount: number, elem: HTMLElement) {\r\n\t\tconst content = <>\r\n\t\t\t<button className=\"webstats-pagination\" name=\"prev\">Prev</button>\r\n\t\t\t<select className=\"webstats-pagination\" name=\"page\" />\r\n\t\t\t<button className=\"webstats-pagination\" name=\"next\">Next</button>\r\n\t\t</>\r\n\t\trender(content, elem)\r\n\t\treturn new Pagination(displayCount, elem)\r\n\t}\r\n\r\n\tupdate(nEntries: number) {\r\n\t\tthis.maxPage = Math.ceil(nEntries / this.displayCount)\r\n\r\n\t\t// Hide all controls when there is only one page\r\n\t\tif (this.maxPage == 1) {\r\n\t\t\tthis.parentElem.classList.add(\"pagination-hidden\")\r\n\t\t} else {\r\n\t\t\tthis.parentElem.classList.remove(\"pagination-hidden\")\r\n\t\t}\r\n\r\n\t\t// Page selector\r\n\t\tif (this.selectElem) {\r\n\t\t\tthis.selectElem.innerHTML = \"\"\r\n\t\t\tfor (let i = 1; i <= this.maxPage; i++) {\r\n\t\t\t\tconst optionElem = document.createElement(\"option\")\r\n\t\t\t\toptionElem.innerText = String(i)\r\n\t\t\t\tthis.selectElem.append(optionElem)\r\n\t\t\t}\r\n\t\t\tthis.selectElem.value = String(this.currentPage)\r\n\t\t}\r\n\r\n\t\t// \"Prev\" button\r\n\t\tif (this.prevButton) this.prevButton.toggleAttribute(\"disabled\", this.currentPage <= 1)\r\n\r\n\t\t// \"Next\" button\r\n\t\tif (this.nextButton) this.nextButton.toggleAttribute(\"disabled\", this.currentPage >= this.maxPage)\r\n\t}\r\n\r\n\tchangePage(page: number) {\r\n\t\tpage = Math.max(1, Math.min(page, this.maxPage))\r\n\t\tthis.currentPage = page\r\n\r\n\t\tthis.selectElem.value = String(this.currentPage)\r\n\t\tif (this.prevButton) this.prevButton.toggleAttribute(\"disabled\", this.currentPage <= 1)\r\n\t\tif (this.nextButton) this.nextButton.toggleAttribute(\"disabled\", this.currentPage >= this.maxPage)\r\n\t}\r\n\r\n\tchangePageAndCallback(page: number) {\r\n\t\tthis.changePage(page)\r\n\t\tif (this.onPageChange) this.onPageChange(this.currentPage)\r\n\t}\r\n\r\n\tgetRange(nEntries?: number): [number, number] {\r\n\t\tconst min = (this.currentPage - 1) * this.displayCount\r\n\t\tconst max = (this.displayCount > 0)\r\n\t\t\t? Math.min(this.currentPage * this.displayCount, nEntries)\r\n\t\t\t: nEntries\r\n\t\treturn [min, max]\r\n\t}\r\n\r\n}\r\n","import Connection from \"./Connection\"\r\nimport Data from \"./Data\"\r\nimport Display from \"./Display\"\r\nimport { convertFormattingCodes } from \"./FormattingCodes\"\r\nimport Pagination from \"./Pagination\"\r\n\r\nexport { Connection, Data, Display, Pagination, convertFormattingCodes }\r\n\r\ndeclare global {\r\n\tinterface Window { webstats: WebStats }\r\n}\r\n\r\nexport type Direction = \"ascending\" | \"descending\"\r\n\r\nexport type TableConfig = {\r\n\tname?: string\r\n\tcolumns?: string[]\r\n\tsortColumn?: string\r\n\tsortDirection?: Direction\r\n}\r\n\r\nexport type WebStatsConfig = {\r\n\t// Either one of these\r\n\thost?: string\r\n\tconnection?: Connection\r\n\r\n\t// Either one of these\r\n\ttableParent?: HTMLTableElement\r\n\ttables?: { [key: string]: { table: HTMLTableElement, pagination?: HTMLElement } }\r\n\r\n\tupdateInterval?: number\r\n\tshowSkins?: boolean\r\n\tdisplayCount?: number\r\n}\r\n\r\nexport default class WebStats {\r\n\tstatic CONNECTION_ERROR_MSG = \"No connection to server. Maybe the server is offline, or the 'host' setting in index.html is incorrect.\"\r\n\r\n\tdisplays: Display[]\r\n\tconnection: Connection\r\n\tdata: Data\r\n\tupdateInterval: number\r\n\tinterval: number\r\n\r\n\tloadingElem?: HTMLElement\r\n\terrorElem?: HTMLElement\r\n\r\n\tconstructor(config: WebStatsConfig) {\r\n\t\tthis.displays = []\r\n\t\tthis.connection = config.connection ?? Connection.json(config.host)\r\n\t\tthis.updateInterval = config.updateInterval ?? 10000\r\n\r\n\t\t// Status HTML elements\r\n\t\tconst optionHideOffline = document.querySelector(\"input.webstats-option#hide-offline\") as HTMLInputElement\r\n\t\tconst statusElem = document.querySelector(\".webstats-status\")\r\n\t\tthis.loadingElem = statusElem?.querySelector(\".webstats-loading-indicator\")\r\n\t\tthis.errorElem = statusElem?.querySelector(\".webstats-error-message\")\r\n\t\tthis.setLoadingStatus(true)\r\n\r\n\t\t// Get data and init\r\n\t\tconst statsPromise = this.connection.getStats()\r\n\t\tconst tableConfigsPromise = this.connection.getTables()\r\n\t\tPromise.all([statsPromise, tableConfigsPromise])\r\n\t\t\t.then(\r\n\t\t\t\t([stats, tableConfigs]) => this.init(stats, tableConfigs, config, optionHideOffline.checked),\r\n\t\t\t\tthis.catchError(WebStats.CONNECTION_ERROR_MSG, config)\r\n\t\t\t)\r\n\t\t\t.catch(this.catchError(undefined, config))\r\n\r\n\t\t// Get saved toggles from cookies\r\n\t\tconst cookies = document.cookie.split(\"; \") ?? []\r\n\t\tcookies.filter(str => str.length > 0).forEach(cookie => {\r\n\t\t\tconst [property, value] = cookie.match(/[^=]+/g)\r\n\t\t\tdocument.documentElement.classList.toggle(property, value == \"true\")\r\n\t\t\tconst el = document.querySelector(\"input.webstats-option#\" + property) as HTMLInputElement\r\n\t\t\tif (el) el.checked = (value == \"true\")\r\n\t\t})\r\n\r\n\t\t// On config option toggle, set the html element's class and store cookie\r\n\t\tdocument.querySelectorAll(\"input.webstats-option\").forEach(el =>\r\n\t\t\tel.addEventListener(\"change\", () => {\r\n\t\t\t\tdocument.documentElement.classList.toggle(el.id, (el as HTMLInputElement).checked)\r\n\t\t\t\t// Set a cookie which expires in 10 years\r\n\t\t\t\tdocument.cookie = `${el.id}=${(el as HTMLInputElement).checked}; max-age=${60 * 60 * 24 * 365 * 10}; SameSite=Lax`\r\n\t\t\t})\r\n\t\t)\r\n\r\n\t\toptionHideOffline?.addEventListener(\"change\", (e) => {\r\n\t\t\tthis.displays.forEach(display => display.changeHideOffline(optionHideOffline.checked))\r\n\t\t})\r\n\r\n\t\twindow.webstats = this\r\n\t}\r\n\r\n\tinit(data, tableConfigs: TableConfig[] | undefined, config: WebStatsConfig, hideOffline: boolean) {\r\n\t\tif (config.tables) {\r\n\t\t\tfor (const tableName in config.tables) {\r\n\t\t\t\tconst tableConfig = tableConfigs\r\n\t\t\t\t\t? tableConfigs.find(tc => (tc.name ?? \"\") == tableName)\r\n\t\t\t\t\t: { colums: data.scoreboard.columns as string[] } as TableConfig\r\n\t\t\t\tif (tableConfig) this.addTableManual(config, tableConfig)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (tableConfigs) {\r\n\t\t\t\tfor (const tableConfig of tableConfigs) {\r\n\t\t\t\t\tthis.addTableAutomatic(config, tableConfig)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.addTableAutomatic(config, { colums: data.scoreboard.columns as string[] } as TableConfig)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.data = new Data(data)\r\n\t\tthis.displays.forEach(display => {\r\n\t\t\tdisplay.init(this.data)\r\n\t\t\tdisplay.hideOffline = hideOffline\r\n\t\t\tdisplay.show()\r\n\t\t})\r\n\r\n\t\t// Set update interval\r\n\t\tif (this.updateInterval > 0) {\r\n\t\t\tthis.startUpdateInterval(true)\r\n\t\t\tdocument.addEventListener(\"visibilitychange\", () => document.hidden\r\n\t\t\t\t? this.stopUpdateInterval() : this.startUpdateInterval())\r\n\t\t}\r\n\r\n\t\tthis.setLoadingStatus(false)\r\n\t}\r\n\r\n\tupdate() {\r\n\t\t// When nobody is online, assume scoreboard does not change\r\n\t\tif (this.data.nOnline > 0) {\r\n\t\t\tthis.connection.getStats().then(data => {\r\n\t\t\t\tthis.data.setStats(data)\r\n\t\t\t\tthis.displays.forEach(display => display.updateStatsAndShow())\r\n\t\t\t}).catch(this.catchError(WebStats.CONNECTION_ERROR_MSG))\r\n\t\t} else {\r\n\t\t\tthis.connection.getOnline().then(data => {\r\n\t\t\t\tthis.data.setOnlineStatus(data)\r\n\t\t\t\tthis.displays.forEach(display => display.updateOnlineStatusAndShow())\r\n\t\t\t}).catch(this.catchError(WebStats.CONNECTION_ERROR_MSG))\r\n\t\t}\r\n\t}\r\n\r\n\tstartUpdateInterval(first?: boolean) {\r\n\t\tthis.interval = setInterval(this.update.bind(this) as TimerHandler, this.updateInterval)\r\n\t\tif (!first) this.update()\r\n\t}\r\n\r\n\tstopUpdateInterval() {\r\n\t\tclearInterval(this.interval)\r\n\t}\r\n\r\n\taddTableManual(config: WebStatsConfig, tableConfig: TableConfig) {\r\n\t\tlet pagination: Pagination\r\n\t\tif (config.displayCount > 0 && config.tables[tableConfig.name ?? \"\"].pagination) {\r\n\t\t\tconst paginationParent = config.tables[tableConfig.name ?? \"\"].pagination\r\n\t\t\tpagination = new Pagination(config.displayCount, paginationParent)\r\n\t\t}\r\n\t\tthis.displays.push(new Display(\r\n\t\t\t{ ...config, table: config.tables[tableConfig.name ?? \"\"].table, pagination: pagination },\r\n\t\t\ttableConfig\r\n\t\t))\r\n\t}\r\n\r\n\taddTableAutomatic(config: WebStatsConfig, tableConfig: TableConfig) {\r\n\t\tconst headerElem = (config.tableParent as HTMLElement)\r\n\t\t\t.appendChild(document.createElement(\"div\"))\r\n\t\theaderElem.classList.add(\"webstats-tableheading\")\r\n\t\tif (tableConfig.name) {\r\n\t\t\theaderElem.innerText = tableConfig.name\r\n\t\t\theaderElem.setAttribute(\"webstats-table\", tableConfig.name)\r\n\t\t}\r\n\r\n\t\tlet pagination: Pagination\r\n\t\tif (config.displayCount > 0) {\r\n\t\t\tconst paginationControls = headerElem.appendChild(document.createElement(\"span\"))\r\n\t\t\tpaginationControls.classList.add(\"webstats-pagination\")\r\n\t\t\tpagination = Pagination.create(config.displayCount, paginationControls)\r\n\t\t}\r\n\r\n\t\tconst tableElem = (config.tableParent as HTMLElement)\r\n\t\t\t.appendChild(document.createElement(\"table\"))\r\n\t\tif (tableConfig.name) tableElem.setAttribute(\"webstats-table\", tableConfig.name)\r\n\t\tthis.displays.push(new Display(\r\n\t\t\t{ ...config, table: tableElem, pagination: pagination },\r\n\t\t\ttableConfig\r\n\t\t))\r\n\t}\r\n\r\n\tsetLoadingStatus(loading: boolean) {\r\n\t\tif (!this.loadingElem) return\r\n\t\tthis.loadingElem.style.display = loading ? \"inline\" : \"none\"\r\n\t}\r\n\r\n\tsetErrorMessage(msg: string, config?: WebStatsConfig) {\r\n\t\tif (this.errorElem) this.errorElem.innerText = msg\r\n\t\telse {\r\n\t\t\tconst spanElem = document.createElement(\"span\")\r\n\t\t\tspanElem.innerText = msg\r\n\t\t\tspanElem.classList.add(\"webstats-error-message\")\r\n\t\t\tif (config?.tableParent) {\r\n\t\t\t\tconfig.tableParent.appendChild(spanElem)\r\n\t\t\t} else if (config?.tables) {\r\n\t\t\t\tfor (const tablename in config.tables) {\r\n\t\t\t\t\tif (config.tables[tablename].table) config.tables[tablename].table.appendChild(spanElem)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcatchError(msg?: string, config?: WebStatsConfig) {\r\n\t\tconst self = this\r\n\t\treturn e => {\r\n\t\t\tconsole.error(e)\r\n\t\t\tif (msg) console.warn(msg)\r\n\t\t\tself.setErrorMessage(msg ?? e, config)\r\n\t\t\tself.setLoadingStatus(false)\r\n\t\t\tself.stopUpdateInterval()\r\n\t\t}\r\n\t}\r\n\r\n}\r\n"],"names":["Connection","all","scores","online","tables","constructor","this","static","host","protocol","startsWith","getStats","async","fetch","json","scoreboard","Promise","getOnline","getScoreboard","then","response","catch","getTables","Data","columns","players","columns_","playernames","data","setStats","entries","nOnline","Object","keys","length","isOnline","player","isAFK","isOffline","getStatus","isCurrentPlayer","includes","setScoreboard","sort","filter","entryName","entry","push","columnName","Player","forEach","val","idx","setOnlineStatus","setPlayernames","isPlayerOrServer","isNonemptyEntry","bind","Intl","Collator","compare","isNonemptyObjective","by","descending","collator","undefined","sensitivity","a_row","b_row","a","b","isNaN","Number","_","score","match","objective","obj","predicate","fromEntries","v","mapper","map","k","e","assign","n","arguments","t","r","prototype","hasOwnProperty","call","apply","o","children","l","type","key","props","indexOf","Array","concat","text","Fragment","TextNode","customAttributes","s","element","render","window","_globalThis","setGlobalThis","renderDOM","i","c","document","ownerDocument","createTextNode","appendChild","u","createDocumentFragment","createElement","jsxComponent","p","d","className","isArray","join","Function","setAttribute","toLowerCase","h","onWillMount","replaceChildren","onDidMount","COLOUR_CODES","FORMATTING_CODES","FORMATTING_CODE_REGEX","convertFormattingCode","part","format","colour","classes","colourType","_jsx","style","parseFormattingCode","code","prev","matches","slice","convertFormattingCodes","value","parts","firstIdx","matchAll","next","index","substring","parseFormattingCodes","columnClass","column","sortColumn","sortDescending","onKeyDown","target","click","Heading","showSkins","onClick","_jsxs","colSpan","tabIndex","Avatar","title","src","Cell","formatted","toLocaleString","PlayerCell","status","Row","Component","values","Map","super","get","Display","table","pagination","hideOffline","rows","sortDirection","onPageChange","page","show","init","updatePagination","getEntries","set","updateStats","entriesHere","some","getScores","scoresHere","row","has","update","updateScoreboard","updateScoreboardAndShow","updateOnlineStatus","updateOnlineStatusAndShow","updateStatsAndShow","changeHideOffline","changePage","min","max","getRange","thClick","getAttribute","th","getElementsByTagName","innerText","focus","string","replace","Pagination","maxPage","displayCount","currentPage","parentElem","selectElem","prevButton","nextButton","elem","querySelector","addEventListener","changePageAndCallback","content","_Fragment","name","nEntries","Math","ceil","classList","add","remove","innerHTML","optionElem","String","append","toggleAttribute","WebStats","displays","connection","updateInterval","interval","loadingElem","errorElem","config","optionHideOffline","statusElem","setLoadingStatus","statsPromise","tableConfigsPromise","stats","tableConfigs","checked","catchError","CONNECTION_ERROR_MSG","cookie","split","str","property","documentElement","toggle","el","querySelectorAll","id","display","webstats","tableName","tableConfig","find","tc","colums","addTableManual","addTableAutomatic","startUpdateInterval","hidden","stopUpdateInterval","first","setInterval","clearInterval","paginationParent","headerElem","tableParent","paginationControls","create","tableElem","loading","setErrorMessage","msg","spanElem","tablename","self","console","error","warn"],"mappings":"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"}